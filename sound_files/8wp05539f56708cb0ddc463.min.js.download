(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1778:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=s(o(0)),a=s(o(1)),n=s(o(5));function s(e){return e&&e.__esModule?e:{default:e}}var i,l,d,u=function(e){function t(){return e.apply(this,arguments)||this}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e);var o=t.prototype;return o.componentDidMount=function(){this.searchBox.focus()},o.render=function(){var t=this;return a.default.createElement("div",{style:p.searchArea},a.default.createElement("span",{className:"fa fa-search",style:p.icon}),a.default.createElement("input",{style:p.input,placeholder:this.props.placeholderText,onChange:this.props.onChange,ref:function(e){t.searchBox=e}}),this.props.clearButton&&a.default.createElement("span",{className:"fa fa-close",style:p.clearIcon,onClick:function(){t.searchBox.value="",t.props.onChange()}}))},t}(a.default.Component);t.default=u,i=u,l="propTypes",d={placeholderText:r.default.string.isRequired,onChange:r.default.func.isRequired,clearButton:r.default.bool},l in i?Object.defineProperty(i,l,{value:d,enumerable:!0,configurable:!0,writable:!0}):i[l]=d;var p={input:{width:"100%",boxSizing:"border-box",padding:"3px 7px",margin:0,borderStyle:"solid",borderWidth:1,borderColor:n.default.light_gray,borderRadius:4,textIndent:22},icon:{position:"absolute",top:6,left:5,fontSize:16,color:n.default.light_gray},clearIcon:{position:"absolute",top:6,right:5,fontSize:16,color:n.default.light_gray,cursor:"pointer"},searchArea:{position:"relative",margin:"10px 0"}};e.exports=t.default},1895:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.assetButtonStyles=void 0;var r=d(o(0)),a=d(o(1)),n=d(o(2532)),s=d(o(19)),i=d(o(3)),l=o(820);function d(e){return e&&e.__esModule?e:{default:e}}var u={button:{paddingLeft:10,paddingRight:10,marginTop:5,fontSize:"large",fontWeight:"lighter",marginRight:10},buttonRow:{display:"flex",flexFlow:"row",alignItems:"center"}};t.assetButtonStyles=u;var p=function(e){var t=e.onSelectRecord,o=e.disabled;return a.default.createElement("span",null,a.default.createElement(s.default,{__useDeprecatedTag:!0,onClick:t,id:"record-asset",className:"share",text:i.default.recordAudio(),icon:"microphone",style:u.button,size:"large",disabled:o}))};p.propTypes={onSelectRecord:r.default.func,disabled:r.default.bool};var c,f,m,h=function(e){function t(){return e.apply(this,arguments)||this}return function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(t,e),t.prototype.render=function(){var e=!this.props.hideAudioRecording;return(0,l.isIE11)()&&(e=!1),a.default.createElement("div",{style:u.buttonRow},a.default.createElement(n.default,{uploadsEnabled:this.props.uploadsEnabled,allowedExtensions:this.props.allowedExtensions,api:this.props.api,onUploadStart:this.props.onUploadStart,onUploadDone:this.props.onUploadDone,onUploadError:this.props.onUploadError}),e&&a.default.createElement(p,{onSelectRecord:this.props.onSelectRecord,disabled:!this.props.uploadsEnabled||this.props.recordDisabled}),a.default.createElement("span",{id:"manage-asset-status"},this.props.statusMessage))},t}(a.default.Component);t.default=h,c=h,f="propTypes",m={uploadsEnabled:r.default.bool.isRequired,allowedExtensions:r.default.string,api:r.default.object,onUploadStart:r.default.func.isRequired,onUploadDone:r.default.func.isRequired,onUploadError:r.default.func.isRequired,onSelectRecord:r.default.func.isRequired,statusMessage:r.default.string,recordDisabled:r.default.bool,hideAudioRecording:r.default.bool},f in c?Object.defineProperty(c,f,{value:m,enumerable:!0,configurable:!0,writable:!0}):c[f]=m},1900:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(o(10)),r=a(o(0)),s=a(o(1)),i=a(o(28));function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var d=function(a){function e(){for(var e,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return l(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e=a.call.apply(a,[this].concat(o))||this),"openFileChooser",function(){return e.refs.uploader.click()}),e}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(e,a);var t=e.prototype;return t.componentDidMount=function(){var r=this.props;(0,n.default)(this.refs.uploader).fileupload({dataType:"json",url:this.props.toUrl,replaceFileInput:!1,add:function(e,t){r.onUploadStart(t);var o=t.files[0].name.includes("mp3")?t.files[0].name:null;o&&i.default.putRecord({study:"sound-dialog-2",study_group:"library-file",event:"upload-file",data_json:o},{includeUserId:!0})},done:function(e,t){r.onUploadDone(t.result)},error:function(e,t){r.onUploadError&&r.onUploadError(e.status)}})},t.componentWillUnmount=function(){(0,n.default)(this.refs.uploader).fileupload("destroy")},t.render=function(){return s.default.createElement("input",{ref:"uploader",className:"uitest-hidden-uploader",type:"file",style:{display:"none"},accept:this.props.allowedExtensions||"*"})},e}(s.default.Component);l(t.default=d,"propTypes",{toUrl:r.default.string.isRequired,allowedExtensions:r.default.string,onUploadStart:r.default.func.isRequired,onUploadDone:r.default.func.isRequired,onUploadError:r.default.func}),window.dashboard=window.dashboard||{},window.dashboard.HiddenUploader=d,e.exports=t.default},2153:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ImageMode=t.AudioErrorType=void 0;var r=m(o(0)),n=m(o(1)),a=o(158),s=m(o(2530)),i=m(o(960)),l=m(o(2531)),d=m(o(28)),u=m(o(1895)),p=m(o(3)),c=o(445),f=o(950);function m(e){return e&&e.__esModule?e:{default:e}}function h(){return(h=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var r in o)Object.prototype.hasOwnProperty.call(o,r)&&(e[r]=o[r])}return e}).apply(this,arguments)}function g(e){return function(e){if(Array.isArray(e)){for(var t=0,o=new Array(e.length);t<e.length;t++)o[t]=e[t];return o}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var v={NONE:"none",INITIALIZE:"initialize",SAVE:"save"};t.AudioErrorType=v;t.ImageMode={FILE:"file",ICON:"icon",URL:"url",DEFAULT:"default"};var E={403:"Quota exceeded. Please delete some files and try again.",413:"The file is too large.",415:"This type of file is not supported.",500:"The server responded with an error.",unknown:"An unknown error occurred."};function S(e){return E[e]||E.unknown}var A=function(t){function e(e){var o;return b(y(o=t.call(this,e)||this),"onStarterAssetsReceived",function(e){var t=JSON.parse(e.response);o.setState({starterAssets:t.starter_assets})}),b(y(o),"onStarterAssetsFailure",function(e){o.setState({statusMessage:"Error loading starter assets: "+S(e.status)})}),b(y(o),"onAssetListReceived",function(e){i.default.reset(e.files),o.setState({assets:i.default.list(o.props.allowedExtensions)})}),b(y(o),"onAssetListFailure",function(e){var t=e.status;o.props.useFilesApi&&404===t?o.onAssetListReceived({files:[]}):o.setState({statusMessage:"Error loading asset list: "+S(t)})}),b(y(o),"onUploadStart",function(e){o.setState({statusMessage:"Uploading..."}),e.submit()}),b(y(o),"onUploadDone",function(e){var t={statusMessage:'File "'+e.filename+'" successfully uploaded!'};o.props.isStartMode?t.starterAssets=[].concat(g(o.state.starterAssets),[e]):(i.default.add(e),o.props.assetsChanged&&o.props.assetsChanged(),t.assets=i.default.list(o.props.allowedExtensions)),o.setState(t)}),b(y(o),"onUploadError",function(e){o.setState({statusMessage:"Error uploading file: "+S(e)}),d.default.putRecord({study:"project-data-integrity",study_group:"v4",event:"asset-upload-error",project_id:o.props.projectId,data_int:e})}),b(y(o),"onSelectRecord",function(){o.setState({recordingAudio:!0})}),b(y(o),"deleteAssetRow",function(e){i.default.remove(e),o.props.assetsChanged&&o.props.assetsChanged(),d.default.putRecord({study:"delete-asset",study_group:o.props.assetChosen&&"function"==typeof o.props.assetChosen?"choose-assets":"manage-assets",event:"confirm",project_id:o.props.projectId,data_json:JSON.stringify({assetName:e,elementId:o.props.elementId})}),o.setState({assets:i.default.list(o.props.allowedExtensions),statusMessage:'File "'.concat(e,'" successfully deleted!')})}),b(y(o),"deleteStarterAssetRow",function(t){var e=g(o.state.starterAssets).filter(function(e){return e.filename!==t});o.setState({starterAssets:e,statusMessage:'File "'.concat(t,'" successfully deleted!')})}),b(y(o),"afterAudioSaved",function(e){o.setState({recordingAudio:!1,audioErrorType:e})}),b(y(o),"defaultAssetProps",function(e){return{key:e.filename,name:e.filename,timestamp:e.timestamp,type:e.category,size:e.size,soundPlayer:o.props.soundPlayer,imagePicker:o.props.imagePicker,projectId:o.props.projectId,elementId:o.props.elementId}}),b(y(o),"getStarterAssetRows",function(){if(!o.props.levelName||0===o.state.starterAssets.length)return[];var t=a.starterAssets.withLevelName(o.props.levelName);return o.state.starterAssets.map(function(e){return n.default.createElement(s.default,h({},o.defaultAssetProps(e),{api:t,onChoose:o.props.assetChosen&&function(){return o.props.assetChosen(c.STARTER_ASSET_PREFIX+e.filename,e.timestamp)},onDelete:function(){return o.deleteStarterAssetRow(e.filename)},levelName:o.props.levelName,hideDelete:!o.props.isStartMode}))})}),b(y(o),"getAssetRows",function(){var t=o.props.useFilesApi?a.files:a.assets;return o.state.assets.map(function(e){return n.default.createElement(s.default,h({},o.defaultAssetProps(e),{api:t,onChoose:o.props.assetChosen&&function(){return o.props.assetChosen(e.filename,e.timestamp)},onDelete:function(){return o.deleteAssetRow(e.filename)}}))})}),b(y(o),"uploadApi",function(){if(o.props.isStartMode)return a.starterAssets.withLevelName(o.props.levelName);var e=o.props.useFilesApi?a.files:a.assets;return e.getProjectId()||(e=e.withProjectId(o.props.projectId)),e}),o.state={assets:null,starterAssets:null,statusMessage:e.uploadsEnabled?"":"This project has been reported for abusive content, so uploading new assets is disabled.",recordingAudio:!1,audioErrorType:v.NONE},o}!function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(e,t);var o=e.prototype;return o.componentDidMount=function(){this.props.levelName?a.starterAssets.getStarterAssets(this.props.levelName,this.onStarterAssetsReceived,this.onStarterAssetsFailure):this.setState({starterAssets:[]});var e=this.props.useFilesApi?a.files:a.assets;e.getProjectId()||(e=e.withProjectId(this.props.projectId)),e.getProjectId()?e.getFiles(this.onAssetListReceived,this.onAssetListFailure):this.setState({assets:[]})},o.render=function(){var e,t=this.state.audioErrorType!==v.INITIALIZE&&this.state.recordingAudio,o=n.default.createElement("div",null,this.state.audioErrorType===v.SAVE&&n.default.createElement("div",null,p.default.audioSaveError()),this.state.audioErrorType===v.INITIALIZE&&n.default.createElement("div",null,p.default.audioInitializeError()),t&&n.default.createElement(l.default,{onUploadDone:this.onUploadDone,afterAudioSaved:this.afterAudioSaved,recordingFileType:this.props.recordingFileType,imagePicker:this.props.imagePicker}),n.default.createElement(u.default,{uploadsEnabled:this.props.uploadsEnabled,allowedExtensions:this.props.allowedExtensions,api:this.uploadApi(),onUploadStart:this.onUploadStart,onUploadDone:this.onUploadDone,onUploadError:this.onUploadError,onSelectRecord:this.onSelectRecord,statusMessage:this.state.statusMessage,recordDisabled:this.state.recordingAudio,hideAudioRecording:this.props.disableAudioRecording}));if(null===this.state.assets||null===this.state.starterAssets)e=n.default.createElement("div",{style:{margin:"1em 0",textAlign:"center"}},n.default.createElement("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"32px"}}));else if(0===this.state.assets.length&&0===this.state.starterAssets.length){var r=".mp3"===this.props.allowedExtensions?n.default.createElement("div",null,n.default.createElement("div",null,'Go to the "Sound library" to find sounds for your project.'),n.default.createElement("div",null,'To upload your own sound, click "Upload File." Your uploaded assets will appear here.')):'Your assets will appear here. Click "Upload File" to add a new asset for this project.';e=n.default.createElement("div",null,n.default.createElement("div",{style:w.emptyText},r),o)}else{var a=[].concat(g(this.getStarterAssetRows()),g(this.getAssetRows()));e=n.default.createElement("div",null,n.default.createElement("div",{style:{maxHeight:"380px",overflowY:"scroll",margin:"1em 0"}},n.default.createElement("table",{style:{width:"100%"}},n.default.createElement("tbody",null,a))),o)}return e},e}(n.default.Component);b(t.default=A,"propTypes",{assetChosen:r.default.func,assetsChanged:r.default.func,allowedExtensions:r.default.string,uploadsEnabled:r.default.bool.isRequired,useFilesApi:r.default.bool,soundPlayer:r.default.object,disableAudioRecording:r.default.bool,recordingFileType:r.default.oneOf(Object.values(f.RecordingFileType)),projectId:r.default.string,levelName:r.default.string,isStartMode:r.default.bool,imagePicker:r.default.bool,elementId:r.default.string});var w={emptyText:{margin:"1em 0",fontSize:"16px",lineHeight:"20px"}}},2154:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.styles=void 0;var r,a,n,s,i,l,d=m(o(1)),u=m(o(0)),p=m(o(17)),c=m(o(5)),f=o(158);function m(e){return e&&e.__esModule?e:{default:e}}function h(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}function g(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var y={image:"fa fa-picture-o",audio:"fa fa-music",video:"fa fa-video-camera",pdf:"fa fa-file-pdf-o",doc:"fa fa-file-text-o",unknown:"fa fa-question"},b={width:"auto",maxWidth:"100%",height:"auto",maxHeight:"100%",marginTop:"50%",transform:"translateY(-50%)",msTransform:"translateY(-50%)",WebkitTransform:"translateY(-50%)"},v={margin:"15px 0",fontSize:"32px"},E={wrapper:{width:60,height:60,margin:"10px auto"},background:{background:"#eee",border:"1px solid #ccc",textAlign:"center"},audioIcon:{color:c.default.purple,marginLeft:"auto",marginRight:"auto",display:"block"},audioWrapper:{display:"flex"}};t.styles=E;var S=function(s){function e(e){var t;g(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(t=s.call(this,e)||this),"clickSoundControl",function(){t.state.isPlayingAudio&&t.props.soundPlayer?(t.setState({isPlayingAudio:!1}),t.props.soundPlayer.stopPlayingURL(t.srcPath)):t.props.soundPlayer&&(t.setState({isPlayingAudio:!0}),t.props.soundPlayer.play(t.srcPath,{onEnded:function(){t.setState({isPlayingAudio:!1})}}))});var o=t.props.api||f.assets;t.props.levelName?o=o.withLevelName(t.props.levelName):t.props.projectId&&(o=o.withProjectId(t.props.projectId));var r=o.basePath(t.props.name),a="";if(t.props.timestamp){var n=new Date(t.props.timestamp);a="?t=".concat(n.valueOf())}return t.srcPath="".concat(r).concat(a),"audio"===t.props.type&&t.props.soundPlayer&&t.props.soundPlayer.register({id:t.srcPath,mp3:t.srcPath}),t.state={isPlayingAudio:!1},t}return h(e,s),e.prototype.render=function(){var e=this.props,t=e.type,o=e.iconStyle,r=e.style;return d.default.createElement("div",{className:"assetThumbnail"},"audio"===t?d.default.createElement(w,{clickSoundControl:this.clickSoundControl,isPlaying:this.state.isPlayingAudio}):d.default.createElement("div",{style:[E.wrapper,r,E.background]},"image"===t?d.default.createElement(_,{src:this.srcPath}):d.default.createElement(R,{type:t,iconStyle:o})))},e}(d.default.Component);g(S,"propTypes",{name:u.default.string.isRequired,timestamp:u.default.string,type:u.default.oneOf(["image","audio","video","pdf","doc"]).isRequired,style:u.default.object,iconStyle:u.default.object,api:u.default.object,projectId:u.default.string,levelName:u.default.string,soundPlayer:u.default.object});var A=(0,p.default)(S);t.default=A;var w=(0,p.default)((a=r=function(e){function t(){return e.apply(this,arguments)||this}return h(t,e),t.prototype.render=function(){var e=this.props.isPlaying?"fa-pause-circle":"fa-play-circle";return d.default.createElement("div",{style:[E.wrapper,E.audioWrapper]},d.default.createElement("i",{onClick:this.props.clickSoundControl,className:"fa "+e+" fa-4x",style:E.audioIcon}))},t}(d.default.Component),g(r,"propTypes",{clickSoundControl:u.default.func,isPlaying:u.default.bool}),a)),_=(0,p.default)((s=n=function(e){function t(){return e.apply(this,arguments)||this}return h(t,e),t.prototype.render=function(){return d.default.createElement("a",{href:this.props.src,target:"_blank",rel:"noopener noreferrer"},d.default.createElement("img",{src:this.props.src,style:b,id:"ui-image-thumbnail"}))},t}(d.default.Component),g(n,"propTypes",{src:u.default.string}),s)),R=(0,p.default)((l=i=function(e){function t(){return e.apply(this,arguments)||this}return h(t,e),t.prototype.render=function(){return d.default.createElement("i",{className:y[this.props.type]||y.unknown,style:[v,this.props.iconStyle]})},t}(d.default.Component),g(i,"propTypes",{type:u.default.oneOf(["image","audio","video","pdf","doc"]).isRequired,iconStyle:u.default.object}),l))},2530:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=u(o(0)),n=u(o(1)),s=u(o(2154)),i=u(o(3)),l=u(o(28)),a=u(o(5)),d=u(o(10));function u(e){return e&&e.__esModule?e:{default:e}}function p(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var f=function(a){function e(){for(var e,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return c(p(e=a.call.apply(a,[this].concat(o))||this),"state",{action:"normal",actionText:"",attemptedUsedDelete:!1}),c(p(e),"confirmDelete",function(){e.setState({action:"confirming delete",actionText:""}),l.default.putRecord({study:"delete-asset",study_group:e.props.onChoose&&"function"==typeof e.props.onChoose?"choose-assets":"manage-assets",event:"initiate",project_id:e.props.projectId,data_json:JSON.stringify({assetName:e.props.name,elementId:e.props.elementId})})}),c(p(e),"cancelDelete",function(){e.setState({action:"normal",actionText:""})}),c(p(e),"handleDelete",function(){e.setState({action:"deleting",actionText:""}),e.props.api.deleteFile(e.props.name,e.props.onDelete,function(){e.setState({action:"confirming delete",actionText:i.default.errorDeleting()})})}),c(p(e),"chooseAsset",function(){e.props.imagePicker||l.default.putRecord({study:"sound-dialog-2",study_group:"library-tab",event:"choose-uploaded-sound",data_json:e.props.name},{includeUserId:!0}),e.props.onChoose()}),c(p(e),"attemptBadDelete",function(){e.setState({attemptedUsedDelete:!0})}),e}return function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(e,a),e.prototype.render=function(){var e,t;this.props.onChoose?t=n.default.createElement("button",{type:"button",onClick:this.chooseAsset},i.default.choose()):t=(this.props.size/1e3).toFixed(2)+" kb";var o=(0,d.default)("#visualization").find('[src*="'.concat(encodeURIComponent(this.props.name),'"]')).length;switch(this.state.action){case"normal":e=n.default.createElement("td",{width:"250",style:{textAlign:"right"}},t,!this.props.hideDelete&&n.default.createElement("button",{type:"button",className:0<o?"":"btn-danger",onClick:0<o?this.attemptBadDelete:this.confirmDelete},n.default.createElement("i",{className:"fa fa-trash-o"})),this.state.attemptedUsedDelete&&n.default.createElement("div",{style:m.deleteWarning},i.default.cannotDeleteUsedImage()));break;case"confirming delete":e=n.default.createElement("td",{width:"250",style:{textAlign:"right"}},n.default.createElement("button",{type:"button",className:"btn-danger",onClick:this.handleDelete},"Delete File"),n.default.createElement("button",{type:"button",onClick:this.cancelDelete},"Cancel"),n.default.createElement("div",{style:m.deleteWarning},i.default.confirmDeleteExplanation()),this.state.actionText);break;case"deleting":e=n.default.createElement("td",{width:"250",style:{textAlign:"right"}},n.default.createElement("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"32px",marginRight:"15px"}}))}return n.default.createElement("tr",{className:"assetRow",onDoubleClick:this.props.onChoose},n.default.createElement("td",{width:"80"},n.default.createElement(s.default,{type:this.props.type,name:this.props.name,timestamp:this.props.timestamp,api:this.props.api,soundPlayer:this.props.soundPlayer,levelName:this.props.levelName})),n.default.createElement("td",null,this.props.name),e)},e}(n.default.Component);c(t.default=f,"propTypes",{name:r.default.string.isRequired,timestamp:r.default.string,type:r.default.oneOf(["image","audio","video","pdf","doc"]).isRequired,size:r.default.number,api:r.default.object.isRequired,onChoose:r.default.func,onDelete:r.default.func.isRequired,soundPlayer:r.default.object,projectId:r.default.string,levelName:r.default.string,hideDelete:r.default.bool,imagePicker:r.default.bool,elementId:r.default.string});var m={deleteWarning:{paddingLeft:"34px",textAlign:"left",color:a.default.red}};e.exports=t.default},2531:function(e,t,o){"use strict";function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=h(o(0)),a=h(o(1)),n=h(o(19)),i=h(o(3)),l=h(o(5)),d=o(158),u=o(1895),p=o(2153),c=h(o(28)),f=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!==s(e)&&"function"!=typeof e)return{default:e};var t=m();if(t&&t.has(e))return t.get(e);var o={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if(Object.prototype.hasOwnProperty.call(e,a)){var n=r?Object.getOwnPropertyDescriptor(e,a):null;n&&(n.get||n.set)?Object.defineProperty(o,a,n):o[a]=e[a]}o.default=e,t&&t.set(e,o);return o}(o(950));function m(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return m=function(){return e},e}function h(e){return e&&e.__esModule?e:{default:e}}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var b=function(t){function e(e){var o;return y(g(o=t.call(this,e)||this),"componentDidMount",function(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?(o.recorder=(0,f.default)(o.props.recordingFileType),navigator.mediaDevices.getUserMedia({audio:!0}).then(o.recorder.init).then(function(){return o.setState({loading:!1})}).catch(function(){return o.props.afterAudioSaved(p.AudioErrorType.INITIALIZE)})):o.props.afterAudioSaved(p.AudioErrorType.INITIALIZE)}),y(g(o),"saveAudio",function(e){o.setState({loading:!0}),d.assets.putAsset(o.state.audioName+o.recorder.getExtension(),e,function(e){o.setState({audioName:"",loading:!1});var t=JSON.parse(e.response);t.filename=decodeURI(t.filename),o.props.onUploadDone(t),o.props.afterAudioSaved(p.AudioErrorType.NONE)},function(e){o.setState({loading:!1}),console.error("Audio Failed to Save: ".concat(e)),o.props.afterAudioSaved(p.AudioErrorType.SAVE)})}),y(g(o),"onNameChange",function(e){o.setState({audioName:e.target.value})}),y(g(o),"onCancel",function(){o.setState({audioName:"",recording:!1},function(){o.props.afterAudioSaved(p.AudioErrorType.NONE),o.recorder.isRecording()&&(clearTimeout(o.recordTimeout),o.recorder.stopRecording())})}),y(g(o),"toggleRecord",function(){o.state.recording?o.stopRecordingAndSave():o.startRecording()}),y(g(o),"startRecording",function(){var e=o.props.imagePicker?"manage-assets":"library-tab";o.recorder.startRecording().then(function(){c.default.putRecord({study:"sound-dialog-2",study_group:e,event:"record-sound",data_json:o.state.audioName},{includeUserId:!0}),o.setState({recording:!o.state.recording})}),o.recordTimeout=setTimeout(o.stopRecordingAndSave,3e4)}),y(g(o),"stopRecordingAndSave",function(){o.state.recording&&(clearTimeout(o.recordTimeout),o.recorder.stopRecording().then(function(e){o.saveAudio(e)}),o.setState({recording:!o.state.recording}))}),o.timeout=null,o.recorder=null,o.state={audioName:"",recording:!1,loading:!0},o}return function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(e,t),e.prototype.render=function(){return a.default.createElement("div",null,a.default.createElement("div",{style:v.buttonRow},a.default.createElement("input",{type:"text",placeholder:i.default.soundName(),onChange:this.onNameChange,value:this.state.audioName}),this.state.recording&&a.default.createElement("span",{style:u.assetButtonStyles.button},a.default.createElement("i",{style:v.recordingIcon,className:"fa fa-circle"}),i.default.recording()),a.default.createElement("span",null,this.state.loading&&0<this.state.audioName.length&&a.default.createElement("div",{style:v.spinner},a.default.createElement("i",{className:"fa fa-spinner fa-spin",style:{fontSize:"20px"}})),a.default.createElement(n.default,{__useDeprecatedTag:!0,onClick:this.toggleRecord,id:"start-stop-record",style:u.assetButtonStyles.button,color:n.default.ButtonColor.blue,icon:this.state.recording?"stop":"circle",text:this.state.recording?i.default.stop():i.default.record(),size:"large",disabled:0===this.state.audioName.length||this.state.loading}),a.default.createElement(n.default,{__useDeprecatedTag:!0,onClick:this.onCancel,id:"cancel-record",style:u.assetButtonStyles.button,color:n.default.ButtonColor.gray,text:i.default.cancel(),size:"large"}))))},e}(a.default.Component);y(t.default=b,"propTypes",{onUploadDone:r.default.func,afterAudioSaved:r.default.func,recordingFileType:r.default.oneOf(Object.values(f.RecordingFileType)),imagePicker:r.default.bool});var v={buttonRow:{display:"flex",flexFlow:"row",justifyContent:"space-between",alignItems:"center"},recordingIcon:{color:"red",margin:5},warning:{textAlign:"left",color:l.default.red},spinner:{display:"inline-block",verticalAlign:"top",marginTop:"16px",marginRight:"10px"}};e.exports=t.default},2532:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=a(o(0)),n=a(o(1)),s=a(o(1900)),i=a(o(19)),l=o(1895),d=a(o(3));function a(e){return e&&e.__esModule?e:{default:e}}function u(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e}var p=function(a){function e(){for(var e,t=arguments.length,o=new Array(t),r=0;r<t;r++)o[r]=arguments[r];return u(function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e=a.call.apply(a,[this].concat(o))||this),"fileUploadClicked",function(){return e.refs.uploader.openFileChooser()}),e}return function(e,t){e.prototype=Object.create(t.prototype),(e.prototype.constructor=e).__proto__=t}(e,a),e.prototype.render=function(){var e=this.props.api,t=e.getUploadUrl(),o=e.wrapUploadDoneCallback(this.props.onUploadDone),r=e.wrapUploadStartCallback(this.props.onUploadStart);return n.default.createElement("span",null,n.default.createElement(s.default,{ref:"uploader",toUrl:t,allowedExtensions:this.props.allowedExtensions,onUploadStart:r,onUploadDone:o,onUploadError:this.props.onUploadError}),n.default.createElement(i.default,{__useDeprecatedTag:!0,onClick:this.fileUploadClicked,className:"share",id:"upload-asset",disabled:!this.props.uploadsEnabled,icon:"upload",text:d.default.uploadFile(),style:l.assetButtonStyles.button,size:"large"}))},e}(n.default.Component);u(t.default=p,"propTypes",{onUploadStart:r.default.func.isRequired,onUploadDone:r.default.func.isRequired,onUploadError:r.default.func,allowedExtensions:r.default.string,uploadsEnabled:r.default.bool.isRequired,api:r.default.object.isRequired}),e.exports=t.default}}]);
